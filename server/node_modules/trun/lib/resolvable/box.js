"use strict";
var inherits = require('util').inherits;
var Resolvable = require('./core/resolvable');


var Box = function (k) {
	Resolvable.call(this);
	this.k = k;
};
inherits(Box, Resolvable);

Box.prototype.resolve = function (runner, ctx) {
	var result = (this.k != null ? ctx.box[this.k] : ctx.box);
	if (this.isCmdArgs) {
		result = runner.toCmdArgs(result);
	}
	return result;
};

Box.prototype.get = function (k) {
	var result = this.ensureNotOrigin();
	result.k = k;
	return result;
};

Object.defineProperties(Box.prototype, {
	cmdArgs: {
		get: function () {
			var result = this.ensureNotOrigin();
			result.isCmdArgs = true;
			return result;
		}
	}
});

Box.box = new Box();


module.exports = Box;
