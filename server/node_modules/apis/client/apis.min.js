!function t(e,r,n){function o(a,i){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!i&&u)return u(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return o(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";var n=t("../../lib/client"),o=window.require;window.require=function(t){return"apis"==t?n:o(t)}},{"../../lib/client":7}],2:[function(t,e,r){"use strict";var n=t("marked_types"),o=t("ops"),s=t("./errors").WebError,a=function(t,e){this.authTransport=t,this.options=o.cloneWithDefaults(e,this.getDefaultOptions()),this.auth=null};a.prototype.getDefaultOptions=function(){return{maxAuthAttempts:10,request:{path:"/service/appToken",method:"create"}}},a.prototype.canAuthenticate=function(){return this.isAuthenticated()||null!=this.authTransport.authenticator&&this.authTransport.authenticator.canAuthenticate()},a.prototype.isAuthenticated=function(){return null!=this.auth&&Date.now()<this.auth.issued+this.auth.maxAge},a.prototype.authenticate=function(t){var e=this.options.request,r=this;this.authTransport.sendAuthenticated(e.path,e.method,e.headers,e.data,e.options,function(e,n){null!=e?t(e):(r.auth=n.data,t())})},a.prototype.ensureAuthenticated=function(t){this.isAuthenticated()?t():this.authenticate(t)},a.prototype.sendAuthenticated=function(t,e,r,n,o,s,a){var i=this;this.callAuthenticated(function(u){n=i.addAuthTokenHeader(n),t.send(e,r,n,o,s,a)},function(t,e){i.applyRenewal(t,e),null!=a&&a(t,e)})},a.prototype.addAuthTokenHeader=function(t){return t=t||{},t.auth=t.auth||{},t.auth.token=this.auth.token,t},a.prototype.callAuthenticated=function(t,e){this.callAuthenticatedInternal(1,t,e)},a.prototype.callAuthenticatedInternal=function(t,e,r){var n=this;this.ensureAuthenticated(function(o){null!=o?r(o):e(function(o,s){null!=o&&401==o.status&&t<n.options.maxAuthAttempts?n.callAuthenticatedInternal(t+1,e,r):r(o,s)})})},a.prototype.applyRenewal=function(t,e){null!=t&&(e=null,n.is(t,s)&&null!=t.result&&(e=t.result)),null!=e&&null!=e.headers&&null!=e.headers.renewal&&(this.auth=e.headers.renewal)},e.exports=a},{"./errors":4,marked_types:13,ops:16}],3:[function(t,e,r){"use strict";var n=t("marked_types"),o=t("ops"),s=t("./errors").WebError,a=function(t){this.auth=t};a.prototype.canAuthenticate=function(){return this.isAuthenticated()},a.prototype.setAuth=function(t){this.auth=t},a.prototype.isAuthenticated=function(){return null!=this.auth&&Date.now()<this.auth.issued+this.auth.maxAge},a.prototype.sendAuthenticated=function(t,e,r,n,o,s,a){n=this.addAuthTokenHeader(n);var i=this;t.send(e,r,n,o,s,function(t,e){i.applyRenewal(t,e),null!=a&&a(t,e)})},a.prototype.addAuthTokenHeader=function(t){return t=t||{},t.auth=t.auth||{},t.auth.token=this.auth.token,t.auth.expected=this.auth.expected,t},a.prototype.applyRenewal=function(t,e){null!=t&&(e=null,n.is(t,s)&&null!=t.result&&(e=t.result)),null!=e&&null!=e.headers&&null!=e.headers.renewal&&(this.auth=e.headers.renewal)},e.exports=a},{"./errors":4,marked_types:13,ops:16}],4:[function(t,e,r){"use strict";var n=t("inherits"),o=t("nerr/lib/error_base"),s=t("../node_client/web_error"),a=function(){o.call(this)};n(a,o),a.prototype.name="NetworkError";var i=function(){o.call(this)};n(i,o),i.prototype.name="TimeoutError";var u=function(t){o.call(this),this.closeEvent=t};n(u,o),u.prototype.name="ConnectionCloseError",u.prototype.getMessage=function(){return this.closeEvent.reason},e.exports={WebError:s,NetworkError:a,TimeoutError:i,ConnectionCloseError:u}},{"../node_client/web_error":11,inherits:12,"nerr/lib/error_base":14}],5:[function(t,e,r){"use strict";var n=t("../node_client/http_adapter"),o=t("./errors").WebError,s=t("./authenticator"),a=t("./http_request"),i=t("./jsonp_request"),u=t("./errors"),c=function(t,e){this.baseUri=t,this.options=e||{},this.adapter=null,this.authenticator=null};c.prototype.setAdapter=function(t){this.adapter=t},c.prototype.setAuthenticator=function(t){this.authenticator=t},c.prototype.setAuth=function(t){this.ensureAuthenticator(),this.authenticator.setAuth(t)},c.prototype.ensureAuthenticator=function(){null==this.authenticator&&(this.authenticator=this.createAuthenticator())},c.prototype.createAuthenticator=function(){return new s},c.prototype.sendAuthenticated=function(t,e,r,n,o,s){this.ensureAuthenticator(),this.authenticator.sendAuthenticated(this,t,e,r,n,o,s)},c.prototype.sendAuthenticatedIfPossible=function(t,e,r,n,o,s){this.ensureAuthenticator(),this.authenticator.canAuthenticate()?this.sendAuthenticated(t,e,r,n,o,s):this.send(t,e,r,n,o,s)},c.prototype.send=function(t,e,r,n,o,s){this.ensureAdapter();var a;if(null==o||null==o.crossDomain)a=this.sendHttp(t,e,r,n,o,s);else switch(o.crossDomain){case"jsonp":a=this.sendJsonp(t,e,r,n,o,s);break;default:throw new Error("Unsupported crossDomain option "+o.crossDomain)}return a},c.prototype.ensureAdapter=function(){null==this.adapter&&(this.adapter=this.createAdapter(this.options.adapter))},c.prototype.createAdapter=function(t){return new n(t)},c.prototype.sendHttp=function(t,e,r,n,o,s){var i=this.adapter.createRequestData(this.baseUri,t,e,r,n,o),u=this;return a.send(i,o,function(t,e){u.handleHttpResult(t,e,o,s)})},c.prototype.sendJsonp=function(t,e,r,n,o,s){var a=this.adapter.createRequestUrl(this.baseUri,t,e,r,n,o),u=this;return i.send(a,o,function(t,e){u.handleResult(t,e,o,s)})},c.prototype.handleHttpResult=function(t,e,r,n){var o;null==t&&(o=this.adapter.parseResponseData(e.status,e.headers,e.body,r)),this.handleResult(t,o,r,n)},c.prototype.handleResult=function(t,e,r,n){null==t&&(t=o.extract(e)),null!=t?n(t):n(t,e)},e.exports=c},{"../node_client/http_adapter":10,"./authenticator":3,"./errors":4,"./http_request":6,"./jsonp_request":8}],6:[function(t,e,r){"use strict";var n=t("./errors").NetworkError,o=function(t){this.isAborted=!1,this.xhr=null,this.cb=null};o.prototype.send=function(t,e){this.cb=e;var r=new XMLHttpRequest;this.xhr=r;var n=this;r.onreadystatechange=function(){4==r.readyState&&(r.onreadystatechange=null,n.isAborted||n.handleResult())},r.open(t.method,t.url);for(var o in t.headers)r.setRequestHeader(o,t.headers[o]);r.send(t.body)},o.prototype.abort=function(){this.isAborted=!0,this.xhr.onreadystatechange=null,this.xhr.abort()},o.prototype.handleResult=function(){var t=this.xhr;t.status?this.cb(null,{status:t.status,headers:{get:function(e){return t.getResponseHeader(e)}},body:t.responseText}):this.cb(new n)},o.send=function(t,e,r){var n=new o(e);return n.send(t,r),n},e.exports=o},{"./errors":4}],7:[function(t,e,r){"use strict";var n=t("./errors"),o=t("./authenticator"),s=t("./app_authenticator"),a=t("./http"),i=t("./http_request"),u=t("./jsonp_request"),c=t("./socket");e.exports={errors:n,Authenticator:o,AppAuthenticator:s,Http:a,HttpRequest:i,JsonpRequest:u,Socket:c}},{"./app_authenticator":2,"./authenticator":3,"./errors":4,"./http":5,"./http_request":6,"./jsonp_request":8,"./socket":9}],8:[function(t,e,r){"use strict";var n=t("./errors").NetworkError,o=function(t){var e=t||{};this.callbackUrlKey=e.callbackUrlKey||this.defaultCallbackUrlKey,this.callbacks=this.getCallbacks(),this.cb=null,this.scriptEl=null,this.callbackId=null};o.prototype.callbacksGlobalPath="apis.jsonp.callbacks",o.prototype.defaultCallbackUrlKey="callback",o.prototype.getCallbacks=function(){if(null==o.callbacks){for(var t=this.callbacksGlobalPath.split("."),e=window,r=0;r<t.length;r++){var n=t[r],s=e[n]||{};e[n]=s,e=s}o.callbacks=e}return o.callbacks},o.prototype.send=function(t,e){this.cb=e,this.initCallback(),t=this.addCallbackToUrl(t),this.injectScript(t)},o.prototype.initCallback=function(){var t=this;this.callbackId=this.createCallbackId(),this.callbacks[this.callbackId]=function(e){t.isAborted||(t.cleanup(),t.handleResult(e))}},o.prototype.createCallbackId=function(){for(var t="cb"+(new Date).getTime(),e=0,r=t;r in this.callbacks;)r=t+"_"+e++;return r},o.prototype.addCallbackToUrl=function(t){var e=t.indexOf("?"),r;return r=0>e?[t,"?",this.callbackUrlKey,"=",this.createCallbackName()].join(""):[t.substr(0,e+1),this.callbackUrlKey,"=",this.createCallbackName(),"&",t.substr(e+1)].join("")},o.prototype.createCallbackName=function(){return[this.callbacksGlobalPath,".",this.callbackId].join("")},o.prototype.createScript=function(){var t=document.createElement("script");t.async=!0;var e=this;return t.onerror=function(t){e.handleScriptErrorEvent(t)},t},o.prototype.injectScript=function(t){var e=this.createScript();this.scriptEl=e;var r=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=r.firstChild;n?r.insertBefore(e,r.firstChild):r.appendChild(e),e.src=t},o.prototype.handleScriptErrorEvent=function(t){this.isAborted||(this.cleanup(),this.cb(new n))},o.prototype.abort=function(){this.isAborted=!0,this.cleanup()},o.prototype.cleanup=function(){this.removeCallback(),this.removeScripEl()},o.prototype.removeCallback=function(){delete this.callbacks[this.callbackId]},o.prototype.removeScripEl=function(){var t=this.scriptEl;null!=t&&t.parentNode&&(t.parentNode.removeChild(t),this.scriptEl=null)},o.prototype.handleResult=function(t){var e=t.headers||{};t.headers=e,t.status=e.status,this.cb(null,t)},o.send=function(t,e,r){var n=new o(e);return n.send(t,r),n},e.exports=o},{"./errors":4}],9:[function(t,e,r){"use strict";var n=t("./errors"),o=t("./authenticator"),s=function(t,e,r){this.basePath=t,this.socketUri=e||this.defaultSocketUri,this.protocols=r,this.onSocketCreated=null,this.onMessage=null,this.webSocketClass=WebSocket,this.authenticator=null,this.socket=null,this.requests={},this.abortFunc=this.createAbortFunc()};s.prototype.defaultSocketUri="/socket",s.prototype.headerSeparator="\n\n",s.prototype.defaultTimeout=null,s.prototype.setWebSocketClass=function(t){this.webSocketClass=t},s.prototype.setAuthenticator=function(t){this.authenticator=t},s.prototype.setAuth=function(t){this.ensureAuthenticator(),this.authenticator.setAuth(t)},s.prototype.ensureAuthenticator=function(){null==this.authenticator&&(this.authenticator=this.createAuthenticator())},s.prototype.createAuthenticator=function(){return new o},s.prototype.createAbortFunc=function(){var t=this;return function(){t.handleAbort(this)}},s.prototype.createSocket=function(){var t=this.webSocketClass;return new t(this.socketUri,this.protocols)},s.prototype.connect=function(t){if(null!=this.socket)switch(this.socket.readyState){case 0:t&&this.socket.addEventListener("open",function(){t()});break;case 1:t&&t();break;default:this.socket=null}if(null==this.socket){this.socket=this.createSocket(),this.onSocketCreated&&this.onSocketCreated(this.socket),t&&this.socket.addEventListener("open",function(){t()});var e=this;this.socket.addEventListener("message",function(t){e.handleMessage(t)}),this.socket.addEventListener("close",function(t){e.handleClose(t)})}},s.prototype.handleMessage=function(t){var e=this.parse(t.data),r=null!=e.headers?e.headers.requestId:null;if(null!=r){var o=this.requests[r];if(o){var s=o.cb;this.clearRequest(o,r);var a=n.WebError.extract(e);null!=a?s(a):s(null,e)}}else null!=this.onMessage&&this.onMessage(e)},s.prototype.createRequestId=function(){for(var t=""+(new Date).getTime(),e=0,r=t;r in this.requests;)r=t+"_"+e++;return r},s.prototype.clearRequest=function(t){delete this.requests[t.id];var e=t.timeout;null!=e&&clearTimeout(e)},s.prototype.close=function(){null!=this.socket&&this.socket.close()},s.prototype.sendAuthenticated=function(t,e,r,n,o,s){this.authenticator.sendAuthenticated(this,t,e,r,n,o,s)},s.prototype.sendAuthenticatedIfPossible=function(t,e,r,n,o,s){this.ensureAuthenticator(),this.authenticator.canAuthenticate()?this.sendAuthenticated(t,e,r,n,o,s):this.send(t,e,r,n,o,s)},s.prototype.send=function(t,e,r,n,o,s){var a=this;this.connect(function(){a.sendInternal(t,e,r,n,o,s)})},s.prototype.sendInternal=function(t,e,r,n,o,s){r=r||{},r.method=e,r.path=this.getEffectivePath(t);var a;s&&(a=this.createRequest(o,s),r.requestId=a.id);var i;i=void 0===n?"":JSON.stringify(n);var u=[JSON.stringify(r),i].join(this.headerSeparator);return this.socket.send(u),a},s.prototype.getEffectivePath=function(t){var e=t;return this.basePath&&(e=this.basePath+t),e},s.prototype.createRequest=function(t,e){var r=this.createRequestId(),n={id:r,cb:e,options:t,abort:this.abortFunc};return n.timeout=this.createTimeout(n),this.requests[r]=n,n},s.prototype.createTimeout=function(t){var e=t.options,r=null,n=null!=e&&null!=e.timeout?e.timeout:this.defaultTimeout;if(null!=n){var o=this;r=setTimeout(function(){o.handleTimeout(t)},n)}return r},s.prototype.handleTimeout=function(t){var e=t.cb;this.clearRequest(t),e(new n.TimeoutError)},s.prototype.handleAbort=function(t){this.clearRequest(t)},s.prototype.handleClose=function(t){for(var e in this.requests){var r=this.requests[e],o=r.cb;this.clearRequest(r),o(new n.ConnectionCloseError(t))}},s.prototype.parse=function(t){var e=t.indexOf(this.headerSeparator),r=t.substring(0,e),n=t.substring(e+this.headerSeparator.length),o=JSON.parse(r),s={headers:o,data:this.parseBody(n)};return null!=o.status&&(s.status=o.status),s},s.prototype.parseBody=function(t){var e;return t&&(e=JSON.parse(t)),e},e.exports=s},{"./authenticator":3,"./errors":4}],10:[function(t,e,r){"use strict";var n=t("ops"),o=function(t){this.options=n.cloneWithDefaults(t,this.getDefaultOptions())};o.prototype.getDefaultOptions=function(){return{transform:{headers:{req:{method:"X-Method",contentType:"Content-type",auth:{token:"X-Auth",expected:"X-AuthExpected"}},res:{renewal:{token:"X-AuthRenewal",issued:"X-AuthRenewalIssued",maxAge:"X-AuthRenewalMaxAge"}}},url:{headers:"headers",body:"body"}},defaultContentType:"application/json"}},o.prototype.createRequestData=function(t,e,r,n,o,s){var a=this.createMethod(r,s),i=this.createBody(o,s),u=i&&this.canHaveBody(a,s),c=this.createHeaders(r,n,u,s),h=null;!u&&i&&(h={body:i},i=null);var l=this.createUrl(t,e,h,s);return{url:l,method:a,headers:c,body:i}},o.prototype.createRequestUrl=function(t,e,r,n,o,s){return"get"!=r&&(n=n||{},n.method=r),this.createUrl(t,e,{headers:this.stringifyHeaders(n,s),body:this.createBody(o,s)},s)},o.prototype.parseResponseData=function(t,e,r,n){return e.constructor===Object&&(e={get:function(t){return e[t]}}),{status:t,headers:this.parseHeaders(e,n),data:this.parseBody(r,n)}},o.prototype.canHaveBody=function(t,e){return"GET"!=t&&"HEAD"!=t},o.prototype.createUrl=function(t,e,r,n){var o=[t,e];if(null!=r){var s=this.createQuery(r,n);s&&o.push("?",s)}return o.join("")},o.prototype.createMethod=function(t,e){return{get:"GET",head:"HEAD",options:"OPTIONS"}[t]||"POST"},o.prototype.createQuery=function(t,e){var r=[],n=this.options.transform.url;for(var o in t){var s=t[o];if(s){var a=n[o];a&&r.push(this.createQueryItem(n[o],s))}}return r.length>0?r.join("&"):null},o.prototype.createQueryItem=function(t,e){return[t,encodeURIComponent(e)].join("=")},o.prototype.createHeaders=function(t,e,r,n){e=e||{};var o={};if(e.http)for(var s in e.http)o[s]=e.http[s];var a=this.options.transform.headers.req;return"get"!=t&&"head"!=t&&"create"!=t&&"options"!=t&&(o[a.method]=t),this.applyHeaders(a,o,e,n),r&&!e[a.contentType]&&(o[a.contentType]=this.options.defaultContentType),o},o.prototype.applyHeaders=function(t,e,r,n){r.contentType&&(e[t.contentType]=r.contentType),null!=r.auth&&this.applyAuthHeaders(t.auth,e,r.auth,n)},o.prototype.applyAuthHeaders=function(t,e,r,n){r.token&&(e[t.token]=r.token,r.expected&&(e[t.expected]=r.expected))},o.prototype.stringifyHeaders=function(t,e){var r=null;if(null!=t){var n=t.http;n&&delete t.http,r=JSON.stringify(t),n&&(t.http=n)}return r},o.prototype.createBody=function(t,e){var r;return void 0!==t&&(r=JSON.stringify(t)),r},o.prototype.parseHeaders=function(t,e){var r={},n=this.options.transform.headers.res,o=this.parseRenewalHeaders(n.renewal,t,e);return o&&(r.renewal=o),r},o.prototype.parseRenewalHeaders=function(t,e,r){var n=null,o=e.get(t.token);if(o){n={token:o};var s=parseInt(e.get(t.issued),10);isNaN(s)||(n.issued=s);var a=parseInt(e.get(t.maxAge),10);isNaN(a)||(n.maxAge=a)}return n},o.prototype.parseBody=function(t){return t?JSON.parse(t):void 0},e.exports=o},{ops:16}],11:[function(t,e,r){"use strict";var n=t("inherits"),o=t("marked_types"),s=t("nerr/lib/error_base"),a=function(t){s.call(this),this.result=t,this.status=t.status;var e=t.data||{};this._message=e.message,this.status=t.status,this.code=e.code};n(a,s),o.mark(a,"apis:(client):WebError"),a.prototype.name="WebError",a.prototype.getMessage=function(){return this._message},a.extract=function(t){var e=t.status,r=null;return 200!=e&&204!=e&&(r=new a(t)),r},e.exports=a},{inherits:12,marked_types:13,"nerr/lib/error_base":14}],12:[function(t,e,r){e.exports="function"==typeof Object.create?function n(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function o(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],13:[function(t,e,r){"use strict";var n=function(t){for(var e=null;null!=t;)null!=t.typeMarker_&&(e=t.typeMarker_),t=t.super_;return e},o=function(t,e){var r=n(t),o=e;r&&(o+=[r,e].join(" ")),t.typeMarker_=o,t.prototype.typeMarker_=o},s=function(t,e){var r=!1;if(null!=t&&t.typeMarker_){var o=n(e);o&&(r=o.length==t.typeMarker_.length?t.typeMarker_==o:0===t.typeMarker_.indexOf(o)&&" "==t.typeMarker_[o.length]&&"\\"!=t.typeMarker_[o.length-1])}return r};e.exports={mark:o,is:s}},{}],14:[function(t,e,r){"use strict";var n=t("inherits"),o=function(){Error.call(this),this.captureStackTrace()};n(o,Error),o.prototype.name="ErrorBase",o.prototype.captureStackTrace=function(){if(Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else{var t=new Error,e=this;t.toString=function(){return e.toString()};var r=function(){return t.stack};Object.defineProperties?Object.defineProperties({stack:r}):this.getStackTrace=r}},o.prototype.toString=function(){var t=this.name,e=this.getMessage();return e&&(t=[t,e].join(": ")),t},o.prototype.getMessage=function(){return null},o.prototype.getStackTrace=function(){return this.stack},Object.defineProperties&&Object.defineProperties(o.prototype,{message:{get:function(){return this.getMessage()}}}),e.exports=o},{inherits:15}],15:[function(t,e,r){e.exports=t(12)},{}],16:[function(t,e,r){"use strict";var n=function(){};n.prototype.isDict=function(t){return null!=t&&t.constructor===Object},n.prototype.defines=function(t,e){return void 0!==t[e]},n.prototype.applyDefaults=function(t,e,r){var n;if(null==t)r&&(e=this.clone(e)),n=e;else if(n=t,null!=e)for(var o in e){var s=e[o];if(this.defines(t,o)){if(this.isDict(s)){var a=t[o];this.isDict(a)&&this.applyDefaults(a,s)}}else r&&(s=this.clone(s)),t[o]=s}return n},n.prototype.clone=function(t){return this.cloneValueWithDefaults(t)},n.prototype.cloneWithDefaults=function(t,e,r){var n;return n=null==t?r?this.clone(e):e:this.cloneValueWithDefaults(t,e,r)},n.prototype.cloneValueWithDefaults=function(t,e,r){return null!=t&&(this.isDict(t)?t=this.cloneDictWithDefaults(t,e,r):Array.isArray(t)&&(t=this.cloneArray(t))),t},n.prototype.cloneDict=function(t){return this.cloneDictWithDefaults(t)},n.prototype.cloneDictWithDefaults=function(t,e,r){var n={},o;this.isDict(e)||(e=null);for(o in t){var s;null!=e&&o in e&&(s=e[o]),n[o]=this.cloneValueWithDefaults(t[o],s,r)}if(null!=e)for(o in e)this.defines(t,o)||(n[o]=r?this.clone(e[o]):e[o]);return n},n.prototype.cloneArray=function(t){for(var e=[],r=0;r<t.length;r++)e.push(this.clone(t[r]));return e};var o=new n;o.Ops=n;var s={applyDefaults:function(t,e,r){return o.applyDefaults(t,e,r)},cloneWithDefaults:function(t,e,r){return o.cloneWithDefaults(t,e,r)},clone:function(t){return o.clone(t)}};e.exports=s},{}]},{},[1]);